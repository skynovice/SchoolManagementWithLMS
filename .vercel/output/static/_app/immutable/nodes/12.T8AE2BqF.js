import{S as qe,i as Ne,s as Se,n as ie,d as u,a as B,b as q,c as o,w as d,e as b,f as g,g as T,h as N,j as p,t as j,k as S,r as Ae,D as K,G as Pe,H as Be,F as ve,q as Ee}from"../chunks/BVH3f4ly.js";import{e as Ce}from"../chunks/CtnloIfX.js";import"../chunks/IHki7fMi.js";import{s as J}from"../chunks/DtlnWW8f.js";import{g as He}from"../chunks/NCEsWWdp.js";function De(a,e,s){const t=a.slice();return t[14]=e[s],t}function Ie(a){let e,s="‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏´‡∏•‡∏±‡∏Å‡∏™‡∏π‡∏ï‡∏£‡πÉ‡∏´‡∏°‡πà";return{c(){e=p("a"),e.textContent=s,this.h()},l(t){e=b(t,"A",{href:!0,class:!0,"data-svelte-h":!0}),K(e)!=="svelte-1gr1y0z"&&(e.textContent=s),this.h()},h(){d(e,"href","/courses/create"),d(e,"class","btn-primary svelte-my854w")},m(t,r){q(t,e,r)},d(t){t&&u(e)}}}function Oe(a){let e,s=Ce(a[2]),t=[];for(let r=0;r<s.length;r+=1)t[r]=Ve(De(a,s,r));return{c(){e=p("div");for(let r=0;r<t.length;r+=1)t[r].c();this.h()},l(r){e=b(r,"DIV",{class:!0});var i=g(e);for(let l=0;l<t.length;l+=1)t[l].l(i);i.forEach(u),this.h()},h(){d(e,"class","courses-grid svelte-my854w")},m(r,i){q(r,e,i);for(let l=0;l<t.length;l+=1)t[l]&&t[l].m(e,null)},p(r,i){if(i&247){s=Ce(r[2]);let l;for(l=0;l<s.length;l+=1){const c=De(r,s,l);t[l]?t[l].p(c,i):(t[l]=Ve(c),t[l].c(),t[l].m(e,null))}for(;l<t.length;l+=1)t[l].d(1);t.length=s.length}},d(r){r&&u(e),Pe(t,r)}}}function Ue(a){var c,f;let e,s,t=((c=a[1])==null?void 0:c.role)==="teacher"?"‡∏Ñ‡∏∏‡∏ì‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏´‡∏•‡∏±‡∏Å‡∏™‡∏π‡∏ï‡∏£":"‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏´‡∏•‡∏±‡∏Å‡∏™‡∏π‡∏ï‡∏£‡πÉ‡∏ô‡∏£‡∏∞‡∏ö‡∏ö",r,i,l=((f=a[1])==null?void 0:f.role)==="teacher"&&Te();return{c(){e=p("div"),s=p("p"),r=j(t),i=S(),l&&l.c(),this.h()},l(w){e=b(w,"DIV",{class:!0});var h=g(e);s=b(h,"P",{class:!0});var v=g(s);r=T(v,t),v.forEach(u),i=N(h),l&&l.l(h),h.forEach(u),this.h()},h(){d(s,"class","svelte-my854w"),d(e,"class","empty-state svelte-my854w")},m(w,h){q(w,e,h),o(e,s),o(s,r),o(e,i),l&&l.m(e,null)},p(w,h){var v,D;h&2&&t!==(t=((v=w[1])==null?void 0:v.role)==="teacher"?"‡∏Ñ‡∏∏‡∏ì‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏´‡∏•‡∏±‡∏Å‡∏™‡∏π‡∏ï‡∏£":"‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏´‡∏•‡∏±‡∏Å‡∏™‡∏π‡∏ï‡∏£‡πÉ‡∏ô‡∏£‡∏∞‡∏ö‡∏ö")&&B(r,t),((D=w[1])==null?void 0:D.role)==="teacher"?l||(l=Te(),l.c(),l.m(e,null)):l&&(l.d(1),l=null)},d(w){w&&u(e),l&&l.d()}}}function Fe(a){let e,s="‡∏Å‡∏≥‡∏•‡∏±‡∏á‡πÇ‡∏´‡∏•‡∏î‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•...";return{c(){e=p("div"),e.textContent=s,this.h()},l(t){e=b(t,"DIV",{class:!0,"data-svelte-h":!0}),K(e)!=="svelte-whnzab"&&(e.textContent=s),this.h()},h(){d(e,"class","loading svelte-my854w")},m(t,r){q(t,e,r)},p:ie,d(t){t&&u(e)}}}function ze(a){let e,s;function t(l,c){return c&4&&(e=null),e==null&&(e=!!l[7](l[14])),e?Me:Ge}let r=t(a,-1),i=r(a);return{c(){i.c(),s=Ee()},l(l){i.l(l),s=Ee()},m(l,c){i.m(l,c),q(l,s,c)},p(l,c){r===(r=t(l,c))&&i?i.p(l,c):(i.d(1),i=r(l),i&&(i.c(),i.m(s.parentNode,s)))},d(l){l&&u(s),i.d(l)}}}function Le(a){let e,s,t,r,i,l=a[14].is_published?"üì§ ‡∏¢‡∏Å‡πÄ‡∏•‡∏¥‡∏Å‡πÄ‡∏ú‡∏¢‡πÅ‡∏û‡∏£‡πà":"üì¢ ‡πÄ‡∏ú‡∏¢‡πÅ‡∏û‡∏£‡πà",c,f,w,h,v="üóëÔ∏è ‡∏•‡∏ö",D,A;function m(){return a[9](a[14])}function E(){return a[10](a[14])}return{c(){e=p("a"),s=j("‚úèÔ∏è ‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç"),r=S(),i=p("button"),c=j(l),w=S(),h=p("button"),h.textContent=v,this.h()},l(_){e=b(_,"A",{href:!0,class:!0});var n=g(e);s=T(n,"‚úèÔ∏è ‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç"),n.forEach(u),r=N(_),i=b(_,"BUTTON",{class:!0});var k=g(i);c=T(k,l),k.forEach(u),w=N(_),h=b(_,"BUTTON",{class:!0,"data-svelte-h":!0}),K(h)!=="svelte-v1472a"&&(h.textContent=v),this.h()},h(){d(e,"href",t="/lms/edit/"+a[14].id),d(e,"class","btn-small btn-edit svelte-my854w"),d(i,"class",f="btn-small "+(a[14].is_published?"btn-unpublish":"btn-publish")+" svelte-my854w"),d(h,"class","btn-small btn-delete svelte-my854w")},m(_,n){q(_,e,n),o(e,s),q(_,r,n),q(_,i,n),o(i,c),q(_,w,n),q(_,h,n),D||(A=[ve(i,"click",m),ve(h,"click",E)],D=!0)},p(_,n){a=_,n&4&&t!==(t="/lms/edit/"+a[14].id)&&d(e,"href",t),n&4&&l!==(l=a[14].is_published?"üì§ ‡∏¢‡∏Å‡πÄ‡∏•‡∏¥‡∏Å‡πÄ‡∏ú‡∏¢‡πÅ‡∏û‡∏£‡πà":"üì¢ ‡πÄ‡∏ú‡∏¢‡πÅ‡∏û‡∏£‡πà")&&B(c,l),n&4&&f!==(f="btn-small "+(a[14].is_published?"btn-unpublish":"btn-publish")+" svelte-my854w")&&d(i,"class",f)},d(_){_&&(u(e),u(r),u(i),u(w),u(h)),D=!1,Be(A)}}}function Ge(a){let e,s="üìù ‡∏•‡∏á‡∏ó‡∏∞‡πÄ‡∏ö‡∏µ‡∏¢‡∏ô",t,r;function i(){return a[11](a[14])}return{c(){e=p("button"),e.textContent=s,this.h()},l(l){e=b(l,"BUTTON",{class:!0,"data-svelte-h":!0}),K(e)!=="svelte-1j6ve15"&&(e.textContent=s),this.h()},h(){d(e,"class","btn-small btn-enroll svelte-my854w")},m(l,c){q(l,e,c),t||(r=ve(e,"click",i),t=!0)},p(l,c){a=l},d(l){l&&u(e),t=!1,r()}}}function Me(a){let e,s="‚úÖ ‡∏•‡∏á‡∏ó‡∏∞‡πÄ‡∏ö‡∏µ‡∏¢‡∏ô‡πÅ‡∏•‡πâ‡∏ß";return{c(){e=p("button"),e.textContent=s,this.h()},l(t){e=b(t,"BUTTON",{class:!0,"data-svelte-h":!0}),K(e)!=="svelte-5vn9u5"&&(e.textContent=s),this.h()},h(){d(e,"class","btn-small btn-enrolled svelte-my854w"),e.disabled=!0},m(t,r){q(t,e,r)},p:ie,d(t){t&&u(e)}}}function Ve(a){var be,pe;let e,s,t,r=a[14].title+"",i,l,c,f=((be=a[14].subjects)==null?void 0:be.code)+"",w,h,v=((pe=a[14].subjects)==null?void 0:pe.name)+"",D,A,m,E,_=(a[14].description||"‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏Ñ‡∏≥‡∏≠‡∏ò‡∏¥‡∏ö‡∏≤‡∏¢")+"",n,k,V,O,z,Q=a[14].is_published?"‡πÄ‡∏ú‡∏¢‡πÅ‡∏û‡∏£‡πà‡πÅ‡∏•‡πâ‡∏ß":"‡∏£‡πà‡∏≤‡∏á",Y,Z,ne,L,oe,R=je(a[14])+"",$,ce,ue,W,X=new Date(a[14].created_at).toLocaleDateString("th-TH")+"",x,de,H,U,fe,ee,he,_e;function me(y,C){var P,F;if(((P=y[1])==null?void 0:P.role)==="teacher"&&y[14].teacher_id===y[0].id)return Le;if(((F=y[1])==null?void 0:F.role)==="student")return ze}let G=me(a),I=G&&G(a);return{c(){e=p("div"),s=p("div"),t=p("div"),i=j(r),l=S(),c=p("div"),w=j(f),h=j(" - "),D=j(v),A=S(),m=p("div"),E=p("div"),n=j(_),k=S(),V=p("div"),O=p("div"),z=p("span"),Y=j(Q),ne=S(),L=p("span"),oe=j("üë• "),$=j(R),ce=j(" ‡∏Ñ‡∏ô"),ue=S(),W=p("div"),x=j(X),de=S(),H=p("div"),U=p("a"),fe=j("üëÅÔ∏è ‡∏î‡∏π"),he=S(),I&&I.c(),_e=S(),this.h()},l(y){e=b(y,"DIV",{class:!0});var C=g(e);s=b(C,"DIV",{class:!0});var P=g(s);t=b(P,"DIV",{class:!0});var F=g(t);i=T(F,r),F.forEach(u),l=N(P),c=b(P,"DIV",{class:!0});var te=g(c);w=T(te,f),h=T(te," - "),D=T(te,v),te.forEach(u),P.forEach(u),A=N(C),m=b(C,"DIV",{class:!0});var M=g(m);E=b(M,"DIV",{class:!0});var we=g(E);n=T(we,_),we.forEach(u),k=N(M),V=b(M,"DIV",{class:!0});var le=g(V);O=b(le,"DIV",{class:!0});var se=g(O);z=b(se,"SPAN",{class:!0});var ye=g(z);Y=T(ye,Q),ye.forEach(u),ne=N(se),L=b(se,"SPAN",{});var re=g(L);oe=T(re,"üë• "),$=T(re,R),ce=T(re," ‡∏Ñ‡∏ô"),re.forEach(u),se.forEach(u),ue=N(le),W=b(le,"DIV",{});var ke=g(W);x=T(ke,X),ke.forEach(u),le.forEach(u),de=N(M),H=b(M,"DIV",{class:!0});var ae=g(H);U=b(ae,"A",{href:!0,class:!0});var ge=g(U);fe=T(ge,"üëÅÔ∏è ‡∏î‡∏π"),ge.forEach(u),he=N(ae),I&&I.l(ae),ae.forEach(u),M.forEach(u),_e=N(C),C.forEach(u),this.h()},h(){d(t,"class","course-title svelte-my854w"),d(c,"class","course-subject svelte-my854w"),d(s,"class","course-header svelte-my854w"),d(E,"class","course-description svelte-my854w"),d(z,"class",Z="status-badge "+(a[14].is_published?"status-published":"status-draft")+" svelte-my854w"),d(O,"class","course-status svelte-my854w"),d(V,"class","course-meta svelte-my854w"),d(U,"href",ee="/lms/course/"+a[14].id),d(U,"class","btn-small btn-view svelte-my854w"),d(H,"class","course-actions svelte-my854w"),d(m,"class","course-body svelte-my854w"),d(e,"class","course-card svelte-my854w")},m(y,C){q(y,e,C),o(e,s),o(s,t),o(t,i),o(s,l),o(s,c),o(c,w),o(c,h),o(c,D),o(e,A),o(e,m),o(m,E),o(E,n),o(m,k),o(m,V),o(V,O),o(O,z),o(z,Y),o(O,ne),o(O,L),o(L,oe),o(L,$),o(L,ce),o(V,ue),o(V,W),o(W,x),o(m,de),o(m,H),o(H,U),o(U,fe),o(H,he),I&&I.m(H,null),o(e,_e)},p(y,C){var P,F;C&4&&r!==(r=y[14].title+"")&&B(i,r),C&4&&f!==(f=((P=y[14].subjects)==null?void 0:P.code)+"")&&B(w,f),C&4&&v!==(v=((F=y[14].subjects)==null?void 0:F.name)+"")&&B(D,v),C&4&&_!==(_=(y[14].description||"‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏Ñ‡∏≥‡∏≠‡∏ò‡∏¥‡∏ö‡∏≤‡∏¢")+"")&&B(n,_),C&4&&Q!==(Q=y[14].is_published?"‡πÄ‡∏ú‡∏¢‡πÅ‡∏û‡∏£‡πà‡πÅ‡∏•‡πâ‡∏ß":"‡∏£‡πà‡∏≤‡∏á")&&B(Y,Q),C&4&&Z!==(Z="status-badge "+(y[14].is_published?"status-published":"status-draft")+" svelte-my854w")&&d(z,"class",Z),C&4&&R!==(R=je(y[14])+"")&&B($,R),C&4&&X!==(X=new Date(y[14].created_at).toLocaleDateString("th-TH")+"")&&B(x,X),C&4&&ee!==(ee="/lms/course/"+y[14].id)&&d(U,"href",ee),G===(G=me(y))&&I?I.p(y,C):(I&&I.d(1),I=G&&G(y),I&&(I.c(),I.m(H,null)))},d(y){y&&u(e),I&&I.d()}}}function Te(a){let e,s="‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏´‡∏•‡∏±‡∏Å‡∏™‡∏π‡∏ï‡∏£‡πÅ‡∏£‡∏Å";return{c(){e=p("a"),e.textContent=s,this.h()},l(t){e=b(t,"A",{href:!0,class:!0,"data-svelte-h":!0}),K(e)!=="svelte-1fdjtfv"&&(e.textContent=s),this.h()},h(){d(e,"href","/courses/create"),d(e,"class","btn-primary svelte-my854w")},m(t,r){q(t,e,r)},d(t){t&&u(e)}}}function Je(a){var D,A;let e,s,t,r=((D=a[1])==null?void 0:D.role)==="teacher"?"‡∏´‡∏•‡∏±‡∏Å‡∏™‡∏π‡∏ï‡∏£‡∏Ç‡∏≠‡∏á‡∏â‡∏±‡∏ô":"‡∏´‡∏•‡∏±‡∏Å‡∏™‡∏π‡∏ï‡∏£‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î",i,l,c,f=((A=a[1])==null?void 0:A.role)==="teacher"&&Ie();function w(m,E){return m[3]?Fe:m[2].length===0?Ue:Oe}let h=w(a),v=h(a);return{c(){e=p("div"),s=p("div"),t=p("h1"),i=j(r),l=S(),f&&f.c(),c=S(),v.c(),this.h()},l(m){e=b(m,"DIV",{class:!0});var E=g(e);s=b(E,"DIV",{class:!0});var _=g(s);t=b(_,"H1",{class:!0});var n=g(t);i=T(n,r),n.forEach(u),l=N(_),f&&f.l(_),_.forEach(u),c=N(E),v.l(E),E.forEach(u),this.h()},h(){d(t,"class","page-title svelte-my854w"),d(s,"class","page-header svelte-my854w"),d(e,"class","courses-container svelte-my854w")},m(m,E){q(m,e,E),o(e,s),o(s,t),o(t,i),o(s,l),f&&f.m(s,null),o(e,c),v.m(e,null)},p(m,[E]){var _,n;E&2&&r!==(r=((_=m[1])==null?void 0:_.role)==="teacher"?"‡∏´‡∏•‡∏±‡∏Å‡∏™‡∏π‡∏ï‡∏£‡∏Ç‡∏≠‡∏á‡∏â‡∏±‡∏ô":"‡∏´‡∏•‡∏±‡∏Å‡∏™‡∏π‡∏ï‡∏£‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î")&&B(i,r),((n=m[1])==null?void 0:n.role)==="teacher"?f||(f=Ie(),f.c(),f.m(s,null)):f&&(f.d(1),f=null),h===(h=w(m))&&v?v.p(m,E):(v.d(1),v=h(m),v&&(v.c(),v.m(e,null)))},i:ie,o:ie,d(m){m&&u(e),f&&f.d(),v.d()}}}function je(a){var e;return((e=a.course_enrollments)==null?void 0:e.length)||0}function Ke(a,e,s){const t={};let r=null,i=null,l=[],c=!0;Ae(async()=>{const{data:{session:n}}=await J.auth.getSession();if(!n){He("/login");return}s(0,r=n.user),await f(),await w(),s(3,c=!1)});async function f(){if(!r)return;const{data:n}=await J.from("profiles").select("*").eq("id",r.id).single();s(1,i=n)}async function w(){if(r)try{let n=J.from("courses").select(`
          *,
          subjects (
            name,
            code
          ),
          course_enrollments (
            id,
            student_id
          )
        `);(i==null?void 0:i.role)==="teacher"?n=n.eq("teacher_id",r.id):n=n.eq("is_published",!0);const{data:k,error:V}=await n.order("created_at",{ascending:!1});if(V){console.error("Error loading courses:",V);return}k&&s(2,l=k)}catch(n){console.error("Failed to load courses:",n)}}async function h(n,k){const{error:V}=await J.from("courses").update({is_published:!k}).eq("id",n);V||await w()}async function v(n){if(confirm("‡∏Ñ‡∏∏‡∏ì‡πÅ‡∏ô‡πà‡πÉ‡∏à‡∏´‡∏£‡∏∑‡∏≠‡πÑ‡∏°‡πà‡∏ó‡∏µ‡πà‡∏à‡∏∞‡∏•‡∏ö‡∏´‡∏•‡∏±‡∏Å‡∏™‡∏π‡∏ï‡∏£‡∏ô‡∏µ‡πâ?")){const{error:k}=await J.from("courses").delete().eq("id",n);k||await w()}}async function D(n){try{const{error:k}=await J.from("course_enrollments").insert({course_id:n,student_id:r.id});k?(console.error("Enrollment error:",k),alert("‡πÄ‡∏Å‡∏¥‡∏î‡∏Ç‡πâ‡∏≠‡∏ú‡∏¥‡∏î‡∏û‡∏•‡∏≤‡∏î‡πÉ‡∏ô‡∏Å‡∏≤‡∏£‡∏•‡∏á‡∏ó‡∏∞‡πÄ‡∏ö‡∏µ‡∏¢‡∏ô: "+k.message)):(await w(),alert("‡∏•‡∏á‡∏ó‡∏∞‡πÄ‡∏ö‡∏µ‡∏¢‡∏ô‡πÄ‡∏£‡∏µ‡∏¢‡∏ö‡∏£‡πâ‡∏≠‡∏¢‡πÅ‡∏•‡πâ‡∏ß!"))}catch(k){console.error("Failed to enroll:",k),alert("‡πÄ‡∏Å‡∏¥‡∏î‡∏Ç‡πâ‡∏≠‡∏ú‡∏¥‡∏î‡∏û‡∏•‡∏≤‡∏î‡πÉ‡∏ô‡∏Å‡∏≤‡∏£‡∏•‡∏á‡∏ó‡∏∞‡πÄ‡∏ö‡∏µ‡∏¢‡∏ô")}}function A(n){var k;return(k=n.course_enrollments)==null?void 0:k.some(V=>V.student_id===r.id)}return[r,i,l,c,h,v,D,A,t,n=>h(n.id,n.is_published),n=>v(n.id),n=>D(n.id)]}class Ze extends qe{constructor(e){super(),Ne(this,e,Ke,Je,Se,{params:8})}get params(){return this.$$.ctx[8]}}export{Ze as component};
